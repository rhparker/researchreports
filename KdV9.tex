% \documentclass{book}

\documentclass[12pt]{article}
\usepackage[pdfborder={0 0 0.5 [3 2]}]{hyperref}%
\usepackage[left=1in,right=1in,top=1in,bottom=1in]{geometry}%
\usepackage[shortalphabetic]{amsrefs}%
\usepackage{amsmath}
\usepackage{enumerate}
\usepackage{enumitem}
\usepackage{amssymb}                
\usepackage{amsmath}                
\usepackage{amsfonts}
\usepackage{amsthm}
\usepackage{bbm}
\usepackage[table,xcdraw]{xcolor}
\usepackage{tikz}
\usepackage{float}
\usepackage{booktabs}
\usepackage{svg}
\usepackage{mathtools}
\usepackage{cool}
\usepackage{url}
\usepackage{graphicx,epsfig}
\usepackage{makecell}
\usepackage{array}

\def\noi{\noindent}
\def\T{{\mathbb T}}
\def\R{{\mathbb R}}
\def\N{{\mathbb N}}
\def\C{{\mathbb C}}
\def\Z{{\mathbb Z}}
\def\P{{\mathbb P}}
\def\E{{\mathbb E}}
\def\Q{\mathbb{Q}}
\def\ind{{\mathbb I}}

\graphicspath{ {images9/} }

\begin{document}

\section*{10 March 2017}
Last week's results look good; it seems like we have a method for finding eigenvalues, and they appear to be where we expect/want them to be. Now we repeat our experiment with different paramaters to see what happens, and we also try this on another system.

\subsection*{5th order KdV equation}
We use the 5th order KdV equation with speed $c = 40.9355$. As always, we start with a single pulse for a value of $c$ for which the exact solution is known, and use parameter continuation to increase $c$ to our desired value. Here we use domain size $L = 25$, i.e. interval $[-25, 25]$. For periodic BCs, continuation code was run with $N = 500$ grid points. For Fourier spectral methods, continuation code was run with $N = 128$ grid points.

\subsubsection*{Double Pulse 1}
Double Pulse 1 has two real eigenvalues which are negatives of each other. First we use finite difference methods with periodic BCs. Here is a table of the positive real eigenvalue for increasing values of $N$, the number of grid points. Although we ran the continuation code for 500 grid points, we need $N = 1000$ grid points before we see the appropriate eigenvalue picture. Here is the table of eigenvalues, found using \texttt{eigs}:
\begin{figure}[H]
\begin{tabular}{l|ll}
$N$    & Positive real eigenvalue      &  Difference      \\ \hline
  1000 &       2.8573  &             \\ 
  2000 &       3.3513  &      0.4940 \\ 
  4000 &       3.4627  &      0.1115 \\ 
  8000 &       3.4900  &      0.0272 \\ 
\end{tabular}
\end{figure}

Plotting the log of the difference versus the log of the grid size:
\begin{figure}[H]
\includegraphics[width=8.5cm]{1double1fdeigdiff}
\end{figure}

We have 2nd order convergence, as expected, so that is good. It looks like we are converging to something around 3.5. Now let's try Fourier. Since our matrices will not get too big, we can use \texttt{eig}.

\begin{figure}[H]
\begin{tabular}{l|ll}
$N$    & Positive real eigenvalue      &  Difference      \\ \hline
  128  &        3.5072  &             \\ 
  256  &        3.4990  &      0.0082      \\ 
  512  &        3.4990  &      5.4199e-07  \\ 
  1024 &        3.4990  &      1.0284e-07  \\
  2048 &        3.4990  &      8.9820e-07  \\ 
\end{tabular}
\end{figure}
To test for exponential convergence, we can plot the difference versus the log of the grid size (not shown), but if we do this we don't get a nice straight line. Sine the last three differences are the same order of magnitude, my guess is that we reach max precision quickly with Fourier methods. Fewer than 128 grid points does not produce accurate results. \\

Based on this, it looks like we can use Fourier methods with $N = 512$ as a ``true'' eigenvalue in this case. Let's try a ``true'' value of 3.4990 for the finite difference methods and see what happens. For this we use grid sizes from 1000 to 8000 in increments of 1000.

\begin{figure}[H]
\includegraphics[width=8.5cm]{1double1fdeigtrue}
\end{figure}

Again, we have 2nd order convergence, so Fourier spectral methods give us a nice estimate of the the ``true'' value within about $1e-7$ or so (looking at the differences in the Fourier table). It appears we can do this using only 512 grid points, which is really nice!\\

For reference, here are the eigenfunctions for the pair of real eigenvalues for Double Pulse 1. These use Fourier spectral methods with $N = 1024$. As expected the two eigenfunctions are reflections of each other over the y-axis.
\begin{figure}[H]
\includegraphics[width=8.5cm]{1double1fouriereigenfnplus}
\includegraphics[width=8.5cm]{1double1fouriereigenfnminus}
\end{figure}


\subsubsection*{Double Pulse 2}
Here we do the same thing we did last time. We use an exponentially weighted space with weight $a = 0.2$ to separate the eigenvalues from the absolute spectrum. First, we use finite difference methods with periodic BCs. The eigenvalue pattern looks exactly the same as it did with $L = 100$, i.e. we have a Left Eigenvalue which appears to be converging to a nonzero value on the imaginary axis, and a Right Eigenvalue which appears to be converging to 0. The eigenfunction of the Right Eigenvalue appears to be an exponentially weighted version of the derivative of the double pulse, so that is good. Here are the eigenvalues. We use grid points from 1000 to 10000 in increments of 1000. Above 10000 or so grid points, it's hard to get good results from \texttt{fsolve}.

\begin{figure}[H]
\begin{tabular}{l|ll}
$N$    & Left eigenvalue      &  Right eigenvalue    \\ \hline
  1000 &   -0.0258 + 2.0161i  &    0.0177 + 1.8828i  \\ 
  2000 &   -0.0081 + 1.1472i  &    0.0062 + 0.9465i  \\ 
  3000 &   -0.0037 + 0.9019i  &    0.0028 + 0.6316i  \\ 
  4000 &   -0.0021 + 0.7987i  &    0.0016 + 0.4739i  \\
  5000 &   -0.0013 + 0.7461i  &    0.0010 + 0.3791i  \\ 
  6000 &   -0.0009 + 0.7160i  &    0.0007 + 0.3159i  \\ 
  7000 &   -0.0007 + 0.6973i  &    0.0005 + 0.2709i  \\ 
  8000 &   -0.0005 + 0.6848i  &    0.0004 + 0.2371i  \\ 
  9000 &   -0.0004 + 0.6762i  &    0.0003 + 0.2109i  \\
 10000 &   -0.0003 + 0.6701i  &    0.0003 + 0.1906i  \\ 
\end{tabular}
\end{figure}
First let's look at the Right Eigenvalue, which we expect to converge to 0 as the mesh size goes to 0 (number of grid points go in infinity). Plotting the log of the absolute value of the Right Eigenvalue vs the log of the mesh size, we see that this is indeed the case. We get first order convergence like we did before.

\begin{figure}[H]
\includegraphics[width=8.5cm]{1double2fdrighteigabs}
\end{figure}

Next let's look at the Left Eigenvalue. It looks like the imaginary part is converging to something like 0.670. First, check to make sure the real part is converging to 0 like before.

\begin{figure}[H]
\includegraphics[width=8.5cm]{1double2fdlefteigreal}
\end{figure}

We get 2nd order convergence of the real part of the Left Eigenvalue to 0 (as before), so this is good. Before we deal with the imaginary part, let's look at Fourier.

\begin{figure}[H]
\begin{tabular}{l|ll}
$N$    & Left eigenvalue      &  Right eigenvalue    \\ \hline
  128  &     -0.4647e-05 + 0.6430i &       3.3100e-05  +  0.0403i \\ 
  256  &      0.1733e-05 + 0.6423i &      -1.2287e-11  +  2.2605e-05i \\ 
  512  &      0.1735e-05 + 0.6423i &      -3.0773e-04  +  0i\\ 
  1024 &      0.1692e-05 + 0.6423i &      -4.0926e-09  +  5.9097e-04i\\
  2048 &      2.7662e-06 + 0.6423i &      1.9930e-06   +  0.0062i
\end{tabular}
\end{figure}

We don't get a nice convergence pattern here, most likely since we are near max precision like we were for Double Pulse 1. For the Left Eigenvalue, the imaginary part seems to rapidly converge to 0.6423. The real part is always of order of magnitude $1e-05$, but this deviation from 0 is likely due to the numerical method since the finite difference method converges nicely and since this seems to be about the order of magnitude of this method from what we saw above.\\

What we can do is use \texttt{fsolve} on the eigenvalue problem $(J -\lambda f) = 0$ ($J$ is Jacobian of problem linearized about double pulse). We set the eigenvalue to $0.6423i$ (i.e. get rid of the tiny real part), and use the eigenfunction we got as a starting point. Here is table of the max of the absolute value of the eigenvalue problem $J -\lambda f$ before and after \texttt{fsolve} for different grid sizes.

\begin{figure}[H]
\begin{tabular}{l|ll}
  $N$   &  $\max J -\lambda f$ before \texttt{fsolve}  &  $\max J -\lambda f$ after \texttt{fsolve} \\ \hline
  256   &     4.1982e-11 &   1.4055e-07   \\ 
  512   &     1.5391e-09 &   3.2847e-07   \\ 
  1024  &     5.4523e-08 &   1.8613e-07   \\
  2048  &     2.5028e-06 &   6.0373e-07   \\
\end{tabular}
\end{figure}
We see that by the time we get to 2048 grid points, the \texttt{fsolve}d eigenvector is actually better than the initial one! Even more evidence that these eigenvalues are pure imaginary. Here is a plot of the real and imaginary parts of the corresponding eigenfunction (after \texttt{fsolve}, 2048 grid points); the eigenfunctions are in the exp weighted space.
\begin{figure}[H]
\includegraphics[width=8.5cm]{1double2eigenfnreal}
\includegraphics[width=8.5cm]{1double2eigenfnimag}
\end{figure}
We can convert the eigenfunction back to the unweighted space by multiplying it by $e^{-ax}$, where $a = 0.2$ here. Here is the real and imaginary parts of the unweighted eigenfunctions.
\begin{figure}[H]
\includegraphics[width=8.5cm]{1double2eigenfnrealunweighted}
\includegraphics[width=8.5cm]{1double2eigenfnimagunweighted}
\end{figure}



\end{document}

